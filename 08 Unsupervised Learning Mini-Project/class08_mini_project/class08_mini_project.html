<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Steven Gan">
<meta name="dcterms.date" content="2022-10-23">

<title>class08_mini_project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="class08_mini_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="class08_mini_project_files/libs/quarto-html/quarto.js"></script>
<script src="class08_mini_project_files/libs/quarto-html/popper.min.js"></script>
<script src="class08_mini_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="class08_mini_project_files/libs/quarto-html/anchor.min.js"></script>
<link href="class08_mini_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="class08_mini_project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="class08_mini_project_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="class08_mini_project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="class08_mini_project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="class08_mini_project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="class08_mini_project_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="class08_mini_project_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="class08_mini_project_files/libs/rglWebGL-binding-0.110.2/rglWebGL.js"></script>
<link href="class08_mini_project_files/libs/rglwidgetClass-0.110.2/rgl.css" rel="stylesheet">
<script src="class08_mini_project_files/libs/rglwidgetClass-0.110.2/rglClass.min.js"></script>
<!--html_preserve--><script type="text/plain" id="rgl-vertex-shader">
#line 2 1
// File 1 is the vertex shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif

attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;

#ifdef NEEDS_VNORMAL
attribute vec3 aNorm;
uniform mat4 normMatrix;
varying vec4 vNormal;
#endif

#if defined(HAS_TEXTURE) || defined (IS_TEXT)
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
#endif

#ifdef FIXED_SIZE
uniform vec3 textScale;
#endif

#ifdef FIXED_QUADS
attribute vec3 aOfs;
#endif

#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
varying float normz;
uniform mat4 invPrMatrix;
#else
attribute vec3 aPos1;
attribute vec3 aPos2;
varying float normz;
#endif
#endif // IS_TWOSIDED

#ifdef FAT_LINES
attribute vec3 aNext;
attribute vec2 aPoint;
varying vec2 vPoint;
varying float vLength;
uniform float uAspect;
uniform float uLwd;
#endif


void main(void) {
  
#ifndef IS_BRUSH
#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)
  vPosition = mvMatrix * vec4(aPos, 1.);
#endif
  
#ifndef FIXED_QUADS
  gl_Position = prMatrix * vPosition;
#endif
#endif // !IS_BRUSH
  
#ifdef IS_POINTS
  gl_PointSize = POINTSIZE;
#endif
  
  vCol = aCol;
  
#ifdef NEEDS_VNORMAL
  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));
#endif
  
#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
  /* normz should be calculated *after* projection */
  normz = (invPrMatrix*vNormal).z;
#else
  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));
  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;
  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));
  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;
  normz = pos1.x*pos2.y - pos1.y*pos2.x;
#endif
#endif // IS_TWOSIDED
  
#ifdef NEEDS_VNORMAL
  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);
#endif
  
#if defined(HAS_TEXTURE) || defined(IS_TEXT)
  vTexcoord = aTexcoord;
#endif
  
#if defined(FIXED_SIZE) && !defined(ROTATING)
  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w;
  gl_Position = pos + vec4(aOfs*textScale, 0.);
#endif
  
#if defined(IS_SPRITES) && !defined(FIXED_SIZE)
  vec4 pos = mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w + vec4(aOfs,  0.);
  gl_Position = prMatrix*pos;
#endif
  
#ifdef FAT_LINES
  /* This code was inspired by Matt Deslauriers' code in 
   https://mattdesl.svbtle.com/drawing-lines-is-hard */
  vec2 aspectVec = vec2(uAspect, 1.0);
  mat4 projViewModel = prMatrix * mvMatrix;
  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);
  currentProjected = currentProjected/currentProjected.w;
  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);
  vec2 currentScreen = currentProjected.xy * aspectVec;
  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;
  float len = uLwd;
  vec2 dir = vec2(1.0, 0.0);
  vPoint = aPoint;
  vLength = length(nextScreen - currentScreen)/2.0;
  vLength = vLength/(vLength + len);
  if (vLength > 0.0) {
    dir = normalize(nextScreen - currentScreen);
  }
  vec2 normal = vec2(-dir.y, dir.x);
  dir.x /= uAspect;
  normal.x /= uAspect;
  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);
  gl_Position = currentProjected + offset;
#endif
  
#ifdef IS_BRUSH
  gl_Position = vec4(aPos, 1.);
#endif
}
</script>
<script type="text/plain" id="rgl-fragment-shader">
#line 2 2
// File 2 is the fragment shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
#if defined(HAS_TEXTURE) || defined (IS_TEXT)
varying vec2 vTexcoord;
uniform sampler2D uSampler;
#endif

#ifdef HAS_FOG
uniform int uFogMode;
uniform vec3 uFogColor;
uniform vec4 uFogParms;
#endif

#if defined(IS_LIT) && !defined(FIXED_QUADS)
varying vec4 vNormal;
#endif

#if NCLIPPLANES > 0
uniform vec4 vClipplane[NCLIPPLANES];
#endif

#if NLIGHTS > 0
uniform mat4 mvMatrix;
#endif

#ifdef IS_LIT
uniform vec3 emission;
uniform float shininess;
#if NLIGHTS > 0
uniform vec3 ambient[NLIGHTS];
uniform vec3 specular[NLIGHTS]; // light*material
uniform vec3 diffuse[NLIGHTS];
uniform vec3 lightDir[NLIGHTS];
uniform bool viewpoint[NLIGHTS];
uniform bool finite[NLIGHTS];
#endif
#endif // IS_LIT

#ifdef IS_TWOSIDED
uniform bool front;
varying float normz;
#endif

#ifdef FAT_LINES
varying vec2 vPoint;
varying float vLength;
#endif

void main(void) {
  vec4 fragColor;
#ifdef FAT_LINES
  vec2 point = vPoint;
  bool neg = point.y < 0.0;
  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :
                 -(point.y - vLength)/(1.0 - vLength);
#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)
  if (neg && length(point) <= 1.0) discard;
#endif
  point.y = min(point.y, 0.0);
  if (length(point) > 1.0) discard;
#endif // FAT_LINES
  
#ifdef ROUND_POINTS
  vec2 coord = gl_PointCoord - vec2(0.5);
  if (length(coord) > 0.5) discard;
#endif
  
#if NCLIPPLANES > 0
  for (int i = 0; i < NCLIPPLANES; i++)
    if (dot(vPosition, vClipplane[i]) < 0.0) discard;
#endif
    
#ifdef FIXED_QUADS
    vec3 n = vec3(0., 0., 1.);
#elif defined(IS_LIT)
    vec3 n = normalize(vNormal.xyz);
#endif
    
#ifdef IS_TWOSIDED
    if ((normz <= 0.) != front) discard;
#endif
    
#ifdef IS_LIT
    vec3 eye = normalize(-vPosition.xyz/vPosition.w);
    vec3 lightdir;
    vec4 colDiff;
    vec3 halfVec;
    vec4 lighteffect = vec4(emission, 0.);
    vec3 col;
    float nDotL;
#ifdef FIXED_QUADS
    n = -faceforward(n, n, eye);
#endif
    
#if NLIGHTS > 0
    for (int i=0;i<NLIGHTS;i++) {
      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);
      lightdir = lightDir[i];
      if (!viewpoint[i])
        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;
      if (!finite[i]) {
        halfVec = normalize(lightdir + eye);
      } else {
        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);
        halfVec = normalize(lightdir + eye);
      }
      col = ambient[i];
      nDotL = dot(n, lightdir);
      col = col + max(nDotL, 0.) * colDiff.rgb;
      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];
      lighteffect = lighteffect + vec4(col, colDiff.a);
    }
#endif
    
#else // not IS_LIT
    vec4 colDiff = vCol;
    vec4 lighteffect = colDiff;
#endif
    
#ifdef IS_TEXT
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef HAS_TEXTURE
#ifdef TEXTURE_rgb
    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);
#endif
    
#ifdef TEXTURE_rgba
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef TEXTURE_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;
    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);
#endif
    
#ifdef TEXTURE_luminance
    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);
#endif
    
#ifdef TEXTURE_luminance_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;
    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);
#endif
    
    fragColor = textureColor;

#elif defined(IS_TEXT)
    if (textureColor.a < 0.1)
      discard;
    else
      fragColor = textureColor;
#else
    fragColor = lighteffect;
#endif // HAS_TEXTURE
    
#ifdef HAS_FOG
    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))
    // In Exp and Exp2: use density = density/far
    // fogF will be the proportion of fog
    // Initialize it to the linear value
    float fogF;
    if (uFogMode > 0) {
      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);
      if (uFogMode > 1)
        fogF = mix(uFogParms.w, 1.0, fogF);
      fogF = fogF*uFogParms.z;
      if (uFogMode == 2)
        fogF = 1.0 - exp(-fogF);
      // Docs are wrong: use (density*c)^2, not density*c^2
      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58
      else if (uFogMode == 3)
        fogF = 1.0 - exp(-fogF*fogF);
      fogF = clamp(fogF, 0.0, 1.0);
      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);
    } else gl_FragColor = fragColor;
#else
    gl_FragColor = fragColor;
#endif // HAS_FOG
    
}
</script><!--/html_preserve-->
<script src="class08_mini_project_files/libs/CanvasMatrix4-0.110.2/CanvasMatrix.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link active" data-scroll-target="#exploratory-data-analysis">Exploratory data analysis</a>
  <ul class="collapse">
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data">Preparing the data</a></li>
  <li><a href="#exploratory-data-analysis-1" id="toc-exploratory-data-analysis-1" class="nav-link" data-scroll-target="#exploratory-data-analysis-1">Exploratory data analysis</a></li>
  </ul></li>
  <li><a href="#principle-component-analysis-pca" id="toc-principle-component-analysis-pca" class="nav-link" data-scroll-target="#principle-component-analysis-pca">Principle component analysis (PCA)</a>
  <ul class="collapse">
  <li><a href="#performing-pca" id="toc-performing-pca" class="nav-link" data-scroll-target="#performing-pca">Performing PCA</a></li>
  <li><a href="#interpreting-pca-results" id="toc-interpreting-pca-results" class="nav-link" data-scroll-target="#interpreting-pca-results">Interpreting PCA results</a></li>
  <li><a href="#variance-explained" id="toc-variance-explained" class="nav-link" data-scroll-target="#variance-explained">Variance explained</a></li>
  <li><a href="#communicating-pca-results" id="toc-communicating-pca-results" class="nav-link" data-scroll-target="#communicating-pca-results">Communicating PCA results</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">Hierarchical clustering</a>
  <ul class="collapse">
  <li><a href="#results-of-hierarchical-clustering" id="toc-results-of-hierarchical-clustering" class="nav-link" data-scroll-target="#results-of-hierarchical-clustering">Results of hierarchical clustering</a></li>
  <li><a href="#selecting-number-of-clusters" id="toc-selecting-number-of-clusters" class="nav-link" data-scroll-target="#selecting-number-of-clusters">Selecting number of clusters</a></li>
  </ul></li>
  <li><a href="#combining-methods" id="toc-combining-methods" class="nav-link" data-scroll-target="#combining-methods">Combining methods</a>
  <ul class="collapse">
  <li><a href="#clustering-on-pca-results" id="toc-clustering-on-pca-results" class="nav-link" data-scroll-target="#clustering-on-pca-results">Clustering on PCA results</a></li>
  </ul></li>
  <li><a href="#sensitivityspecificity" id="toc-sensitivityspecificity" class="nav-link" data-scroll-target="#sensitivityspecificity">Sensitivity/Specificity</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">Prediction</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">class08_mini_project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Steven Gan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 23, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory data analysis</h1>
<section id="preparing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-data">Preparing the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fna.data <span class="ot">&lt;-</span> <span class="st">"WisconsinCancer.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>wisc.df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(fna.data, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wisc.df, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       diagnosis radius_mean texture_mean perimeter_mean area_mean
842302         M       17.99        10.38          122.8      1001
842517         M       20.57        17.77          132.9      1326
       smoothness_mean compactness_mean concavity_mean concave.points_mean
842302         0.11840          0.27760         0.3001             0.14710
842517         0.08474          0.07864         0.0869             0.07017
       symmetry_mean fractal_dimension_mean radius_se texture_se perimeter_se
842302        0.2419                0.07871    1.0950     0.9053        8.589
842517        0.1812                0.05667    0.5435     0.7339        3.398
       area_se smoothness_se compactness_se concavity_se concave.points_se
842302  153.40      0.006399        0.04904      0.05373           0.01587
842517   74.08      0.005225        0.01308      0.01860           0.01340
       symmetry_se fractal_dimension_se radius_worst texture_worst
842302     0.03003             0.006193        25.38         17.33
842517     0.01389             0.003532        24.99         23.41
       perimeter_worst area_worst smoothness_worst compactness_worst
842302           184.6       2019           0.1622            0.6656
842517           158.8       1956           0.1238            0.1866
       concavity_worst concave.points_worst symmetry_worst
842302          0.7119               0.2654         0.4601
842517          0.2416               0.1860         0.2750
       fractal_dimension_worst
842302                 0.11890
842517                 0.08902</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>wisc.data <span class="ot">&lt;-</span> wisc.df[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>diagnosis <span class="ot">&lt;-</span> <span class="fu">factor</span>(wisc.df<span class="sc">$</span>diagnosis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploratory-data-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-1">Exploratory data analysis</h2>
<p>Q1: 569 observations in this dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(wisc.df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 569</code></pre>
</div>
</div>
<p>Q2: 212 observations have malignant diagnosis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(diagnosis <span class="sc">==</span> <span class="st">"M"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 212</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table(wisc.df$diagnosis)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Q3: 10 features in the data have “_mean” suffix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">grep</span>(<span class="st">"_mean"</span>, <span class="fu">colnames</span>(wisc.df)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(grepl("_mean", colnames(wisc.df)))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="principle-component-analysis-pca" class="level1">
<h1>Principle component analysis (PCA)</h1>
<section id="performing-pca" class="level2">
<h2 class="anchored" data-anchor-id="performing-pca">Performing PCA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(wisc.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            radius_mean            texture_mean          perimeter_mean 
           1.412729e+01            1.928965e+01            9.196903e+01 
              area_mean         smoothness_mean        compactness_mean 
           6.548891e+02            9.636028e-02            1.043410e-01 
         concavity_mean     concave.points_mean           symmetry_mean 
           8.879932e-02            4.891915e-02            1.811619e-01 
 fractal_dimension_mean               radius_se              texture_se 
           6.279761e-02            4.051721e-01            1.216853e+00 
           perimeter_se                 area_se           smoothness_se 
           2.866059e+00            4.033708e+01            7.040979e-03 
         compactness_se            concavity_se       concave.points_se 
           2.547814e-02            3.189372e-02            1.179614e-02 
            symmetry_se    fractal_dimension_se            radius_worst 
           2.054230e-02            3.794904e-03            1.626919e+01 
          texture_worst         perimeter_worst              area_worst 
           2.567722e+01            1.072612e+02            8.805831e+02 
       smoothness_worst       compactness_worst         concavity_worst 
           1.323686e-01            2.542650e-01            2.721885e-01 
   concave.points_worst          symmetry_worst fractal_dimension_worst 
           1.146062e-01            2.900756e-01            8.394582e-02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(wisc.data, <span class="dv">2</span>, sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            radius_mean            texture_mean          perimeter_mean 
           3.524049e+00            4.301036e+00            2.429898e+01 
              area_mean         smoothness_mean        compactness_mean 
           3.519141e+02            1.406413e-02            5.281276e-02 
         concavity_mean     concave.points_mean           symmetry_mean 
           7.971981e-02            3.880284e-02            2.741428e-02 
 fractal_dimension_mean               radius_se              texture_se 
           7.060363e-03            2.773127e-01            5.516484e-01 
           perimeter_se                 area_se           smoothness_se 
           2.021855e+00            4.549101e+01            3.002518e-03 
         compactness_se            concavity_se       concave.points_se 
           1.790818e-02            3.018606e-02            6.170285e-03 
            symmetry_se    fractal_dimension_se            radius_worst 
           8.266372e-03            2.646071e-03            4.833242e+00 
          texture_worst         perimeter_worst              area_worst 
           6.146258e+00            3.360254e+01            5.693570e+02 
       smoothness_worst       compactness_worst         concavity_worst 
           2.283243e-02            1.573365e-01            2.086243e-01 
   concave.points_worst          symmetry_worst fractal_dimension_worst 
           6.573234e-02            6.186747e-02            1.806127e-02 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wisc.pr <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(wisc.data, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wisc.pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     3.6444 2.3857 1.67867 1.40735 1.28403 1.09880 0.82172
Proportion of Variance 0.4427 0.1897 0.09393 0.06602 0.05496 0.04025 0.02251
Cumulative Proportion  0.4427 0.6324 0.72636 0.79239 0.84734 0.88759 0.91010
                           PC8    PC9    PC10   PC11    PC12    PC13    PC14
Standard deviation     0.69037 0.6457 0.59219 0.5421 0.51104 0.49128 0.39624
Proportion of Variance 0.01589 0.0139 0.01169 0.0098 0.00871 0.00805 0.00523
Cumulative Proportion  0.92598 0.9399 0.95157 0.9614 0.97007 0.97812 0.98335
                          PC15    PC16    PC17    PC18    PC19    PC20   PC21
Standard deviation     0.30681 0.28260 0.24372 0.22939 0.22244 0.17652 0.1731
Proportion of Variance 0.00314 0.00266 0.00198 0.00175 0.00165 0.00104 0.0010
Cumulative Proportion  0.98649 0.98915 0.99113 0.99288 0.99453 0.99557 0.9966
                          PC22    PC23   PC24    PC25    PC26    PC27    PC28
Standard deviation     0.16565 0.15602 0.1344 0.12442 0.09043 0.08307 0.03987
Proportion of Variance 0.00091 0.00081 0.0006 0.00052 0.00027 0.00023 0.00005
Cumulative Proportion  0.99749 0.99830 0.9989 0.99942 0.99969 0.99992 0.99997
                          PC29    PC30
Standard deviation     0.02736 0.01153
Proportion of Variance 0.00002 0.00000
Cumulative Proportion  1.00000 1.00000</code></pre>
</div>
</div>
<p>Q4: 44.3% of the original variance is captured by the PC1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wisc.pr<span class="sc">$</span>sdev[<span class="dv">1</span>] <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(wisc.pr<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4427203</code></pre>
</div>
</div>
<p>Q5: 3 PCs are required for at least 70% of variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> wisc.pr<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(wisc.pr<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var)) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> b <span class="sc">+</span> var[i]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b <span class="sc">&gt;</span> <span class="fl">0.7</span>) {</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>Q6: 7 PCs are required for at least 90% of variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var)) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> b <span class="sc">+</span> var[i]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b <span class="sc">&gt;</span> <span class="fl">0.9</span>) {</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-pca-results" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-pca-results">Interpreting PCA results</h2>
<p>Q7: This is a mess. No distinguishable information and difficult to comprehend.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(wisc.pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.pr<span class="sc">$</span>x[,<span class="dv">1</span>], wisc.pr<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col =</span> diagnosis, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Q8: PC1 and PC2 did a better job in separating samples with Malignant or Benign cancers than PC1 and PC3, where more Malignant and Benign dots mixed with each others.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.pr<span class="sc">$</span>x[,<span class="dv">1</span>], wisc.pr<span class="sc">$</span>x[,<span class="dv">3</span>], <span class="at">col =</span> diagnosis , </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(wisc.pr<span class="sc">$</span>x)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> diagnosis</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, PC2, <span class="at">col =</span> diagnosis) <span class="sc">+</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="variance-explained" class="level2">
<h2 class="anchored" data-anchor-id="variance-explained">Variance explained</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pr.var <span class="ot">&lt;-</span> wisc.pr<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pr.var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.281608  5.691355  2.817949  1.980640  1.648731  1.207357</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pve <span class="ot">&lt;-</span> pr.var<span class="sc">/</span> <span class="fu">sum</span>(pr.var)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve, <span class="at">xlab =</span> <span class="st">"Principal Component"</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Proportion of Variance Explained"</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">"o"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pve, <span class="at">ylab =</span> <span class="st">"Precent of Variance Explained"</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">names.arg =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pve)), <span class="at">las =</span> <span class="dv">2</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> pve, <span class="at">labels =</span> <span class="fu">round</span>(pve, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("factoextra")</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(wisc.pr, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="communicating-pca-results" class="level2">
<h2 class="anchored" data-anchor-id="communicating-pca-results">Communicating PCA results</h2>
<p>Q9: The “concave.points_mean” component of the loading vector of PC1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>wisc.pr<span class="sc">$</span>rotation[<span class="st">"concave.points_mean"</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2608538</code></pre>
</div>
</div>
</section>
</section>
<section id="hierarchical-clustering" class="level1">
<h1>Hierarchical clustering</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>data.scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(wisc.data)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>data.dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data.scaled)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>wisc.hclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(data.dist, <span class="st">"complete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="results-of-hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="results-of-hierarchical-clustering">Results of hierarchical clustering</h2>
<p>Q10: 4 clusters appears at about height is 20.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.hclust)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(wisc.hclust, <span class="at">h =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="selecting-number-of-clusters" class="level2">
<h2 class="anchored" data-anchor-id="selecting-number-of-clusters">Selecting number of clusters</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>wisc.hclust.clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(wisc.hclust, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wisc.hclust.clusters, diagnosis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    diagnosis
wisc.hclust.clusters   B   M
                   1  12 165
                   2   2   5
                   3 343  40
                   4   0   2</code></pre>
</div>
</div>
<p>Q11: Analysis Results: From the evaluation table and the graph below, it can be easily shown that cutree at 4 is the best.</p>
<p>Method: Take the two clusters with highest patients numbers as either the predicted M or B samples, based on the actual diagnosis results of these two clusters, denoted as “1” (clustered M) and “2” (clustered B). And all the rest clusters are considered as indecisive results, denoted as “3” (ind).</p>
<dl>
<dt>Three values are used to judge the results in each case:</dt>
<dd>
False-negative rate (fnR): P{M|2} = P{M2} / P{2} = n{M2} / n{2}
</dd>
<dd>
False-positive rate (fpR): P{B|1} = P{B1} / P{1} = n{B1} / n{1}
</dd>
<dd>
Indecisive rate (indR): P{3} = n{3} / n{Total}
</dd>
</dl>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># clusDiag funtion identify the specific clusters correspond to diagnosis</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>clusDiag <span class="ot">&lt;-</span> <span class="cf">function</span>(clusDiagTable, diag) {</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  arra <span class="ot">&lt;-</span> clusDiagTable <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(diagnosis <span class="sc">==</span> diag) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Freq)) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(arra))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluation of fpR, fnR, and indR</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>evalErr_hclust <span class="ot">&lt;-</span> <span class="cf">function</span>(hclust, k){</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  hclust.clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hclust, <span class="at">k =</span> k)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  compare <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(hclust.clusters, diagnosis))</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  clusM <span class="ot">&lt;-</span> <span class="fu">clusDiag</span>(compare, <span class="st">"M"</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  clusB <span class="ot">&lt;-</span> <span class="fu">clusDiag</span>(compare, <span class="st">"B"</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (clusM <span class="sc">==</span> clusB) {</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Unable to identify coresponding M/B clusters at cutree "</span>, k))</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Major cluster are mixed with M/B samples, as below:"</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">table</span>(hclust.clusters, diagnosis)[clusB,])</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  nM2 <span class="ot">=</span> <span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> hclust.clusters <span class="sc">==</span> clusB)<span class="sc">$</span>Freq</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  nB1 <span class="ot">=</span> <span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> hclust.clusters <span class="sc">==</span> clusM)<span class="sc">$</span>Freq</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">==</span> clusB)<span class="sc">$</span>Freq)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">==</span> clusM)<span class="sc">$</span>Freq)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  n3 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">!=</span> clusM </span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>                <span class="sc">&amp;</span> hclust.clusters <span class="sc">!=</span> clusB)<span class="sc">$</span>Freq)</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  nTot <span class="ot">=</span> <span class="fu">sum</span>(compare<span class="sc">$</span>Freq)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  fnR <span class="ot">&lt;-</span> nM2 <span class="sc">/</span> n2 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  fpR <span class="ot">&lt;-</span> nB1 <span class="sc">/</span> n1 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  indR <span class="ot">&lt;-</span> n3 <span class="sc">/</span> nTot <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">fnR =</span> fnR, <span class="at">fpR =</span> fpR, <span class="at">indR =</span> indR)</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(values)</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluation with sequential cutree value k</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>evalErr_hclust_k <span class="ot">&lt;-</span> <span class="cf">function</span>(hclust, start_k, end_k) {</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  evalDf <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> start_k<span class="sc">:</span>end_k) {</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    values <span class="ot">&lt;-</span> <span class="fu">evalErr_hclust</span>(hclust, i)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    evalDf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(evalDf, values)</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(evalDf)[i <span class="sc">-</span> (start_k <span class="sc">-</span> <span class="dv">1</span>)] <span class="ot">=</span> i</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(evalDf)</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>wisc.hc.evalDf <span class="ot">&lt;-</span> <span class="fu">evalErr_hclust_k</span>(wisc.hclust, <span class="dv">2</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unable to identify coresponding M/B clusters at cutree 2"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
357 210 
[1] "Unable to identify coresponding M/B clusters at cutree 3"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 205 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wisc.hc.evalDf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fnR       fpR      indR
2        NA        NA        NA
3        NA        NA        NA
4  10.44386  6.779661  1.581722
5  10.44386  6.779661  1.581722
6  10.54054  6.779661  3.866432
7  10.54054  6.779661  3.866432
8  10.54054 12.244898 17.750439
9  10.54054 12.244898 17.750439
10 10.54054 12.244898 17.750439</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>bar_hclust_eval <span class="ot">&lt;-</span> <span class="cf">function</span>(hc.evalDf, <span class="at">range_y =</span> <span class="dv">100</span>) {</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  hc.evalDf <span class="ot">&lt;-</span> <span class="fu">melt</span>(hc.evalDf)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hc.evalDf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"k"</span>, <span class="st">"type"</span>, <span class="st">"value"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hc.evalDf, <span class="fu">aes</span>(<span class="at">fill =</span> type, <span class="at">y =</span> value, <span class="at">x =</span> k)) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> type, <span class="at">y =</span> value, <span class="at">x =</span> k)) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cutree k"</span>, <span class="at">y =</span> <span class="st">"Rate value (%)"</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">factor</span>(hc.evalDf<span class="sc">$</span>k[<span class="dv">1</span>]<span class="sc">:</span>hc.evalDf<span class="sc">$</span>k[<span class="fu">length</span>(hc.evalDf<span class="sc">$</span>k)])) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, range_y)) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="dv">2</span>)), </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="fu">bar_hclust_eval</span>(wisc.hc.evalDf, <span class="at">range_y =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Q12: As shown below, method “single” and “average” failed in separating M and B samples, under any Cutree between 2 to 10, with most of their samples mixed in the main cluster, while all other clusters containing only a few samples.</p>
<p>Both “ward.D2” and “complete” can separate B and M samples. The former separate samples Cutree of 2, while the later at 3. In comparing of error rate, however, “complete” method has an overall lower error rate, and false-negative rate, while has a relatively higher indecisive rate, due to 4 clusters it distinguished.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis on different clustering methods</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>hclust_evalErrAna <span class="ot">&lt;-</span> <span class="cf">function</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>(data.dist, start_k, end_k, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"complete"</span>, <span class="st">"single"</span>, <span class="st">"average"</span>, <span class="st">"ward.D2"</span>)) {</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(method)) {</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    hclust.i <span class="ot">&lt;-</span> <span class="fu">hclust</span>(data.dist, method[i])</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(hclust.i)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    hc.evalDf.i <span class="ot">&lt;-</span> <span class="fu">evalErr_hclust_k</span>(hclust.i, start_k, end_k)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(hc.evalDf.i)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"No acceptable clusters for M/B separation under "</span>, </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                   method[i], <span class="st">"-based clustering analysis"</span>))</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">bar_hclust_eval</span>(hc.evalDf.i, <span class="at">range_y =</span> <span class="dv">60</span>))</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hclust_evalErrAna</span>(data.dist, <span class="dv">2</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unable to identify coresponding M/B clusters at cutree 2"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
357 210 
[1] "Unable to identify coresponding M/B clusters at cutree 3"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 205 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unable to identify coresponding M/B clusters at cutree 2"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
357 210 
[1] "Unable to identify coresponding M/B clusters at cutree 3"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
356 210 
[1] "Unable to identify coresponding M/B clusters at cutree 4"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
356 209 
[1] "Unable to identify coresponding M/B clusters at cutree 5"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
356 209 
[1] "Unable to identify coresponding M/B clusters at cutree 6"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
356 208 
[1] "Unable to identify coresponding M/B clusters at cutree 7"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
356 207 
[1] "Unable to identify coresponding M/B clusters at cutree 8"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 207 
[1] "Unable to identify coresponding M/B clusters at cutree 9"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 206 
[1] "Unable to identify coresponding M/B clusters at cutree 10"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 205 
[1] "No acceptable clusters for M/B separation under single-based clustering analysis"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-23-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unable to identify coresponding M/B clusters at cutree 2"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
357 209 
[1] "Unable to identify coresponding M/B clusters at cutree 3"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 209 
[1] "Unable to identify coresponding M/B clusters at cutree 4"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 209 
[1] "Unable to identify coresponding M/B clusters at cutree 5"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 208 
[1] "Unable to identify coresponding M/B clusters at cutree 6"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 202 
[1] "Unable to identify coresponding M/B clusters at cutree 7"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 162 
[1] "Unable to identify coresponding M/B clusters at cutree 8"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
355 162 
[1] "Unable to identify coresponding M/B clusters at cutree 9"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
353 162 
[1] "Unable to identify coresponding M/B clusters at cutree 10"
[1] "Major cluster are mixed with M/B samples, as below:"
  B   M 
353 162 
[1] "No acceptable clusters for M/B separation under average-based clustering analysis"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-23-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-23-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="combining-methods" class="level1">
<h1>Combining methods</h1>
<section id="clustering-on-pca-results" class="level2">
<h2 class="anchored" data-anchor-id="clustering-on-pca-results">Clustering on PCA results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>wisc.pr.hclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(wisc.pr<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]), <span class="st">"ward.D2"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.pr.hclust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(wisc.pr.hclust, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(grps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>grps
  1   2 
203 366 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(diagnosis, grps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         grps
diagnosis   1   2
        B  24 333
        M 179  33</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(grps)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1" "2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">relevel</span>(g, <span class="dv">2</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.pr<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.pr<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> diagnosis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>(wisc.pr<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>, <span class="at">zlab =</span> <span class="st">"PC3"</span>, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"s"</span>, <span class="at">col =</span> grps)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rglwidget</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">height =</span> <span class="dv">400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="rgl75742" style="width:100%;height:650px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl75742">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.321434080600739]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["PC1"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["PC2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["PC3"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"12","centers":"13","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"14","centers":"15","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"16","colors":"17","axes":{"mode":["pretty","pretty","pretty"],"step":[5,5,5],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":4,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,84.465690612793],"modelMatrix":[[0.882021605968475,0,0,4.73823928833008],[0,0.324438810348511,1.20984196662903,-2.38466477394104],[0,-0.891388237476349,0.440346479415894,-87.7529067993164],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370325088501,-304.489013671875],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.882021605968475,0.948595583438873,1.28748691082001],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-16.6693153381348,5.92527198791504,-12.900993347168,8.10786914825439,-5.12573051452637,10.3531942367554],"windowRect":[0,45,256,301],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rgl/fonts/FreeSans.ttf","maxClipPlanes":6,"glVersion":2.1,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,11],"subscenes":[],"flags":34067}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":400,"height":400,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":569,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":569,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":569,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":13,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":6828,"byteOffset":0},{"buffer":0,"byteLength":2276,"byteOffset":6828},{"buffer":0,"byteLength":6828,"byteOffset":9104},{"buffer":0,"byteLength":12,"byteOffset":15932},{"buffer":0,"byteLength":4,"byteOffset":15944},{"buffer":0,"byteLength":12,"byteOffset":15948},{"buffer":0,"byteLength":12,"byteOffset":15960},{"buffer":0,"byteLength":4,"byteOffset":15972},{"buffer":0,"byteLength":12,"byteOffset":15976},{"buffer":0,"byteLength":12,"byteOffset":15988},{"buffer":0,"byteLength":4,"byteOffset":16000},{"buffer":0,"byteLength":12,"byteOffset":16004},{"buffer":0,"byteLength":16,"byteOffset":16016},{"buffer":0,"byteLength":3,"byteOffset":16032},{"buffer":0,"byteLength":4,"byteOffset":16035},{"buffer":0,"byteLength":3,"byteOffset":16039},{"buffer":0,"byteLength":156,"byteOffset":16044},{"buffer":0,"byteLength":4,"byteOffset":16200}],"buffers":[{"byteLength":16204,"bytes":"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\nAAAA/99Ta/8AAAD/AAAA/99Ta/8AAAD/31Nr/99Ta//fU2v/AAAA/99Ta//fU2v/31Nr/99T\na//fU2v/31Nr/99Ta/8AAAD/31Nr/99Ta//fU2v/31Nr/wAAAP8AAAD/31Nr/99Ta//fU2v/\nAAAA/99Ta//fU2v/31Nr/99Ta/8AAAD/AAAA/99Ta/8AAAD/31Nr/99Ta//fU2v/AAAA/99T\na//fU2v/31Nr/wAAAP/fU2v/31Nr/99Ta/8AAAD/AAAA/99Ta//fU2v/AAAA/wAAAP8AAAD/\n31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/wAAAP/fU2v/31Nr/wAAAP8AAAD/31Nr/wAA\nAP8AAAD/AAAA/wAAAP/fU2v/AAAA/wAAAP8AAAD/31Nr/99Ta//fU2v/31Nr/wAAAP/fU2v/\nAAAA/99Ta/8AAAD/AAAA/wAAAP8AAAD/31Nr/99Ta/8AAAD/AAAA/99Ta//fU2v/31Nr/wAA\nAP/fU2v/31Nr/99Ta//fU2v/31Nr/wAAAP8AAAD/31Nr/99Ta/8AAAD/31Nr/99Ta/8AAAD/\nAAAA/99Ta/8AAAD/31Nr/99Ta/8AAAD/31Nr/wAAAP/fU2v/31Nr/wAAAP/fU2v/31Nr/wAA\nAP/fU2v/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/31Nr/wAAAP/fU2v/\nAAAA/wAAAP/fU2v/31Nr/99Ta//fU2v/31Nr/99Ta/8AAAD/31Nr/99Ta//fU2v/31Nr/99T\na//fU2v/31Nr/wAAAP/fU2v/AAAA/wAAAP/fU2v/31Nr/99Ta//fU2v/AAAA/99Ta/8AAAD/\n31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/AAAA/99Ta/8AAAD/31Nr/99T\na//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta/8AAAD/\nAAAA/99Ta//fU2v/AAAA/99Ta/8AAAD/31Nr/99Ta//fU2v/31Nr/wAAAP8AAAD/AAAA/99T\na//fU2v/31Nr/99Ta/8AAAD/31Nr/wAAAP/fU2v/AAAA/wAAAP/fU2v/31Nr/wAAAP/fU2v/\n31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/AAAA/wAAAP8AAAD/31Nr/99Ta//fU2v/31Nr/99T\na//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta/8AAAD/AAAA/99Ta/8AAAD/AAAA/wAAAP/fU2v/\nAAAA/wAAAP/fU2v/31Nr/wAAAP/fU2v/31Nr/wAAAP/fU2v/31Nr/99Ta//fU2v/31Nr/99T\na//fU2v/31Nr/99Ta/8AAAD/31Nr/99Ta/8AAAD/AAAA/99Ta//fU2v/31Nr/99Ta//fU2v/\n31Nr/wAAAP/fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/AAAA/99Ta//fU2v/31Nr/99T\na//fU2v/31Nr/99Ta//fU2v/AAAA/99Ta//fU2v/31Nr/wAAAP/fU2v/31Nr/99Ta//fU2v/\n31Nr/99Ta//fU2v/31Nr/wAAAP/fU2v/AAAA/wAAAP/fU2v/AAAA/99Ta//fU2v/31Nr/99T\na//fU2v/AAAA/99Ta//fU2v/AAAA/99Ta/8AAAD/31Nr/99Ta/8AAAD/31Nr/wAAAP/fU2v/\n31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/wAAAP8AAAD/31Nr/99Ta//fU2v/AAAA/99T\na//fU2v/AAAA/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta/8AAAD/\n31Nr/99Ta//fU2v/31Nr/99Ta/8AAAD/31Nr/wAAAP/fU2v/31Nr/99Ta//fU2v/AAAA/99T\na//fU2v/31Nr/wAAAP/fU2v/AAAA/wAAAP/fU2v/AAAA/99Ta/8AAAD/AAAA/wAAAP/fU2v/\n31Nr/99Ta/8AAAD/31Nr/99Ta/8AAAD/31Nr/99Ta//fU2v/AAAA/wAAAP/fU2v/31Nr/99T\na/8AAAD/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta/8AAAD/\n31Nr/wAAAP8AAAD/31Nr/99Ta//fU2v/31Nr/wAAAP/fU2v/31Nr/99Ta//fU2v/31Nr/99T\na//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/31Nr/99Ta//fU2v/\n31Nr/wAAAP8AAAD/AAAA/wAAAP/fU2v/AAAA/99Ta//C9BLBCjP5v46jj79arxjAc/NwQDth\nB7/JUrfAU4CJP4sfDb/vu+PA0EMkwXa3TsBPo3vASiL5P9e7sT+vMxjAvpJ8wMCqO8CeKQ/A\n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\nAAAAAQ=="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n    \n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n#ifdef TEXTURE_rgb\n    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n#endif\n    \n#ifdef TEXTURE_rgba\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef TEXTURE_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n    \n#ifdef TEXTURE_luminance\n    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n#endif\n    \n#ifdef TEXTURE_luminance_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n#endif\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Use the distance along the first 7 PCs for clustering i.e. wisc.pr$x[, 1:7]</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>wisc.pr.hclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(wisc.pr<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]), <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>wisc.pr.hclust.clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(wisc.pr.hclust, <span class="at">k =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Q13: It works only a little bit better than hclust with 3 PCs, with only 52 incorrect assigned data in comparing to 57. As shown in the Error rate graph, similar results can be obtained with cutree is 2. However, I would argue that this does not necessary guarantee that higher PCs for htclust should result in lower error rate, as the error rate in 30 PCs analysis is surprisingly higher than 3 and 7 PCs analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wisc.pr.hclust.clusters, diagnosis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       diagnosis
wisc.pr.hclust.clusters   B   M
                      1  28 188
                      2 329  24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Analysis on different PCs</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">30</span>)) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  wisc.pr.hclust.i <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(wisc.pr<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>i]), <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  wisc.pr.hc.evalDf.i <span class="ot">&lt;-</span> <span class="fu">evalErr_hclust_k</span>(wisc.pr.hclust.i, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(wisc.pr.hc.evalDf.i)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"No acceptable clusters for M/B separation under "</span>, </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                 method[i], <span class="st">"-based clustering analysis"</span>))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">bar_hclust_eval</span>(wisc.pr.hc.evalDf.i, <span class="at">range_y =</span> <span class="dv">60</span>))</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Q14: No significant difference to previous hclust data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wisc.hclust.clusters, diagnosis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    diagnosis
wisc.hclust.clusters   B   M
                   1  12 165
                   2   2   5
                   3 343  40
                   4   0   2</code></pre>
</div>
</div>
</section>
</section>
<section id="sensitivityspecificity" class="level1">
<h1>Sensitivity/Specificity</h1>
<p>Q15: Based on the graph below, the best sensitivity, 88.68%, achieved at 7 PCs analysis using method “ward.D2” with Cutree at k = 2. The best specificity, however, if stick to the data, would be near 100% when cutree goes to about 10. Yet this is merely a play with the figures, as there will be only a few samples in the clusters when cutree reaches 10. Faily speaking, the highest specificity should be about 93.2%, achieved at 7 PCs clustering using “ward.D2” methods.</p>
<p>Method: (Modify previous evaluation function) Sensitivity (senR): TP / TP + FN (M1 / M1 + M2) Specificity (speR): TN / TN + FN (B2 / B2 + M2)</p>
<p>Generalized complete Functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clusDiag funtion identify the specific clusters correspond to diagnosis</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>clusDiag <span class="ot">&lt;-</span> <span class="cf">function</span>(clusDiagTable, diag) {</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  arra <span class="ot">&lt;-</span> clusDiagTable <span class="sc">%&gt;%</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(diagnosis <span class="sc">==</span> diag) <span class="sc">%&gt;%</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Freq)) <span class="sc">%&gt;%</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(arra))</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluation of Sensitivity and Specificity or Error rate</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>eval_hclust <span class="ot">&lt;-</span> <span class="cf">function</span> (hclust, k, evalMethod, <span class="at">logs =</span> F) {</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (evalMethod <span class="sc">!=</span> <span class="st">"SS"</span> <span class="sc">&amp;</span> evalMethod <span class="sc">!=</span> <span class="st">"Err"</span>) </span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    {<span class="fu">return</span>(<span class="fu">print</span>(<span class="st">"Error in evalMethod"</span>))} </span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  hclust.clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hclust, <span class="at">k =</span> k)</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  compare <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(hclust.clusters, diagnosis))</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  clusM <span class="ot">&lt;-</span> <span class="fu">clusDiag</span>(compare, <span class="st">"M"</span>)</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  clusB <span class="ot">&lt;-</span> <span class="fu">clusDiag</span>(compare, <span class="st">"B"</span>)</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (clusM <span class="sc">==</span> clusB) {</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (logs <span class="sc">==</span> T) {</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Unable to identify M/B clusters at cutree "</span>, k))</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"Major cluster are mixed with M/B samples, as below:"</span>)</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">table</span>(hclust.clusters, diagnosis)[clusB,])</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (evalMethod <span class="sc">==</span> <span class="st">"SS"</span>) {<span class="fu">return</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>))} </span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (evalMethod <span class="sc">==</span> <span class="st">"Err"</span>) {<span class="fu">return</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))}</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (evalMethod <span class="sc">==</span> <span class="st">"SS"</span>) {</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>    nM1 <span class="ot">=</span> <span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> hclust.clusters <span class="sc">==</span> clusM)<span class="sc">$</span>Freq</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>    nB2 <span class="ot">=</span> <span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> hclust.clusters <span class="sc">==</span> clusB)<span class="sc">$</span>Freq</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>    nM <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"M"</span>)<span class="sc">$</span>Freq)</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">==</span> clusB)<span class="sc">$</span>Freq)</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>    senR <span class="ot">&lt;-</span> nM1 <span class="sc">/</span> nM <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>    speR <span class="ot">&lt;-</span> nB2 <span class="sc">/</span> n2 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>    values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">senR =</span> senR, <span class="at">speR =</span> speR)</span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(values)</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (evalMethod <span class="sc">==</span> <span class="st">"Err"</span>) {</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>    nM2 <span class="ot">=</span> <span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> hclust.clusters <span class="sc">==</span> clusB)<span class="sc">$</span>Freq</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>    nB1 <span class="ot">=</span> <span class="fu">filter</span>(compare, diagnosis <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> hclust.clusters <span class="sc">==</span> clusM)<span class="sc">$</span>Freq</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">==</span> clusB)<span class="sc">$</span>Freq)</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">==</span> clusM)<span class="sc">$</span>Freq)</span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a>    n3 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">filter</span>(compare, hclust.clusters <span class="sc">!=</span> clusM </span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">&amp;</span> hclust.clusters <span class="sc">!=</span> clusB)<span class="sc">$</span>Freq)</span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a>    nTot <span class="ot">=</span> <span class="fu">sum</span>(compare<span class="sc">$</span>Freq)</span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a>    fnR <span class="ot">&lt;-</span> nM2 <span class="sc">/</span> n2 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a>    fpR <span class="ot">&lt;-</span> nB1 <span class="sc">/</span> n1 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a>    indR <span class="ot">&lt;-</span> n3 <span class="sc">/</span> nTot <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a>    values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">fnR =</span> fnR, <span class="at">fpR =</span> fpR, <span class="at">indR =</span> indR)</span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(values)</span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluation with sequential cutree value k</span></span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a>eval_hclust_k <span class="ot">&lt;-</span> <span class="cf">function</span>(hclust, start_k, end_k, evalMethod, <span class="at">logs =</span> F) {</span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a>  evalDf <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> start_k<span class="sc">:</span>end_k) {</span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a>    values <span class="ot">&lt;-</span> <span class="fu">eval_hclust</span>(hclust, i, evalMethod, logs)</span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a>    evalDf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(evalDf, values)</span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(evalDf)[i <span class="sc">-</span> (start_k <span class="sc">-</span> <span class="dv">1</span>)] <span class="ot">=</span> i</span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-79"><a href="#cb78-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(evalDf)</span>
<span id="cb78-80"><a href="#cb78-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-81"><a href="#cb78-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-82"><a href="#cb78-82" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting</span></span>
<span id="cb78-83"><a href="#cb78-83" aria-hidden="true" tabindex="-1"></a>bar_hclust_eval <span class="ot">&lt;-</span> <span class="cf">function</span>(hc.evalDf, <span class="at">range_y =</span> <span class="dv">100</span>) {</span>
<span id="cb78-84"><a href="#cb78-84" aria-hidden="true" tabindex="-1"></a>  hc.evalDf <span class="ot">&lt;-</span> <span class="fu">melt</span>(hc.evalDf)</span>
<span id="cb78-85"><a href="#cb78-85" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hc.evalDf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"k"</span>, <span class="st">"type"</span>, <span class="st">"value"</span>)</span>
<span id="cb78-86"><a href="#cb78-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-87"><a href="#cb78-87" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hc.evalDf, <span class="fu">aes</span>(<span class="at">fill =</span> type, <span class="at">y =</span> value, <span class="at">x =</span> k)) <span class="sc">+</span></span>
<span id="cb78-88"><a href="#cb78-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb78-89"><a href="#cb78-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> type, <span class="at">y =</span> value, <span class="at">x =</span> k)) <span class="sc">+</span></span>
<span id="cb78-90"><a href="#cb78-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cutree k"</span>, <span class="at">y =</span> <span class="st">"Rate value (%)"</span>) <span class="sc">+</span></span>
<span id="cb78-91"><a href="#cb78-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb78-92"><a href="#cb78-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">factor</span>(hc.evalDf<span class="sc">$</span>k[<span class="dv">1</span>]<span class="sc">:</span>hc.evalDf<span class="sc">$</span>k[<span class="fu">length</span>(hc.evalDf<span class="sc">$</span>k)])) <span class="sc">+</span></span>
<span id="cb78-93"><a href="#cb78-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, range_y)) <span class="sc">+</span></span>
<span id="cb78-94"><a href="#cb78-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="dv">2</span>)), </span>
<span id="cb78-95"><a href="#cb78-95" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb78-96"><a href="#cb78-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb78-97"><a href="#cb78-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb78-98"><a href="#cb78-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-99"><a href="#cb78-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-100"><a href="#cb78-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis on different clustering methods</span></span>
<span id="cb78-101"><a href="#cb78-101" aria-hidden="true" tabindex="-1"></a>hclust_evalAna <span class="ot">&lt;-</span> <span class="cf">function</span> (</span>
<span id="cb78-102"><a href="#cb78-102" aria-hidden="true" tabindex="-1"></a>    data.dist, <span class="at">start_k =</span> <span class="dv">2</span>, <span class="at">end_k =</span> <span class="dv">10</span>, </span>
<span id="cb78-103"><a href="#cb78-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"complete"</span>, <span class="st">"single"</span>, <span class="st">"average"</span>, <span class="st">"ward.D2"</span>), </span>
<span id="cb78-104"><a href="#cb78-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">dendroPlot =</span> F, evalMethod, <span class="at">logs =</span> F, <span class="at">range_y =</span> <span class="dv">100</span>) {</span>
<span id="cb78-105"><a href="#cb78-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-106"><a href="#cb78-106" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(method)) {</span>
<span id="cb78-107"><a href="#cb78-107" aria-hidden="true" tabindex="-1"></a>    hclust.i <span class="ot">&lt;-</span> <span class="fu">hclust</span>(data.dist, method[i])</span>
<span id="cb78-108"><a href="#cb78-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dendroPlot <span class="sc">==</span> T) {<span class="fu">plot</span>(hclust.i)}</span>
<span id="cb78-109"><a href="#cb78-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-110"><a href="#cb78-110" aria-hidden="true" tabindex="-1"></a>    hc.evalDf.i <span class="ot">&lt;-</span> <span class="fu">eval_hclust_k</span>(hclust.i, start_k, end_k, evalMethod, logs)</span>
<span id="cb78-111"><a href="#cb78-111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-112"><a href="#cb78-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(hc.evalDf.i)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb78-113"><a href="#cb78-113" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"No acceptable clusters for M/B separation under "</span>, </span>
<span id="cb78-114"><a href="#cb78-114" aria-hidden="true" tabindex="-1"></a>                   method[i], <span class="st">"-based clustering analysis"</span>))</span>
<span id="cb78-115"><a href="#cb78-115" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb78-116"><a href="#cb78-116" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-117"><a href="#cb78-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Clustering Method: "</span>, method[i]))</span>
<span id="cb78-118"><a href="#cb78-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">bar_hclust_eval</span>(hc.evalDf.i, range_y))</span>
<span id="cb78-119"><a href="#cb78-119" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-120"><a href="#cb78-120" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-121"><a href="#cb78-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-122"><a href="#cb78-122" aria-hidden="true" tabindex="-1"></a><span class="co">#Analysis on different PCs</span></span>
<span id="cb78-123"><a href="#cb78-123" aria-hidden="true" tabindex="-1"></a>hclustPCs_evalAna <span class="ot">&lt;-</span> <span class="cf">function</span> (</span>
<span id="cb78-124"><a href="#cb78-124" aria-hidden="true" tabindex="-1"></a>    pr, <span class="at">start_k =</span> <span class="dv">2</span>, <span class="at">end_k =</span> <span class="dv">10</span>, <span class="at">PCs =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">30</span>), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"ward.D2"</span>), </span>
<span id="cb78-125"><a href="#cb78-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">dendroPlot =</span> F, evalMethod, <span class="at">logs =</span> F, <span class="at">range_y =</span> <span class="dv">100</span>) {</span>
<span id="cb78-126"><a href="#cb78-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-127"><a href="#cb78-127" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> PCs) {</span>
<span id="cb78-128"><a href="#cb78-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(method)) {</span>
<span id="cb78-129"><a href="#cb78-129" aria-hidden="true" tabindex="-1"></a>      pr.hclust.i <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(pr<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>i]), method[j])</span>
<span id="cb78-130"><a href="#cb78-130" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (dendroPlot <span class="sc">==</span> T) {<span class="fu">plot</span>(pr.hclust.i)}</span>
<span id="cb78-131"><a href="#cb78-131" aria-hidden="true" tabindex="-1"></a>      pr.hc.evalDf.i <span class="ot">&lt;-</span> <span class="fu">eval_hclust_k</span>(pr.hclust.i, start_k, end_k, </span>
<span id="cb78-132"><a href="#cb78-132" aria-hidden="true" tabindex="-1"></a>                                      evalMethod, logs)</span>
<span id="cb78-133"><a href="#cb78-133" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb78-134"><a href="#cb78-134" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(pr.hc.evalDf.i)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb78-135"><a href="#cb78-135" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"No acceptable clusters for M/B separation under Method: "</span>, </span>
<span id="cb78-136"><a href="#cb78-136" aria-hidden="true" tabindex="-1"></a>                     method[j], <span class="st">" for "</span>, i, <span class="st">" PCs"</span>))</span>
<span id="cb78-137"><a href="#cb78-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb78-138"><a href="#cb78-138" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb78-139"><a href="#cb78-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"PCs: "</span>, i, <span class="st">" Clustering method: "</span>, method[j]))</span>
<span id="cb78-140"><a href="#cb78-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">bar_hclust_eval</span>(pr.hc.evalDf.i, range_y))</span>
<span id="cb78-141"><a href="#cb78-141" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-142"><a href="#cb78-142" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-143"><a href="#cb78-143" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test 1: Q11</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#wisc.hclust %&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  eval_hclust_k(2, 10, "Err") %&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  bar_hclust_eval(range_y = 20)</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Test 2: Q12</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co">#data.dist %&gt;%</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  hclust_evalAna(2, 10, dendroPlot = T, evalMethod = "Err", range_y = 60)</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Test 3: Q13</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co">#wisc.pr %&gt;%</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  hclustPCs_evalAna(2, 5, evalMethod = "Err", range_y = 60)</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>data.dist <span class="sc">%&gt;%</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hclust_evalAna</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="at">evalMethod =</span> <span class="st">"SS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Clustering Method: complete"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No acceptable clusters for M/B separation under single-based clustering analysis"
[1] "No acceptable clusters for M/B separation under average-based clustering analysis"
[1] "Clustering Method: ward.D2"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>wisc.pr <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hclustPCs_evalAna</span>(<span class="at">method =</span> <span class="fu">c</span>(<span class="st">"complete"</span>, <span class="st">"single"</span>, <span class="st">"average"</span>, <span class="st">"ward.D2"</span>), <span class="at">evalMethod =</span> <span class="st">"SS"</span>, <span class="at">logs =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PCs: 3 Clustering method: complete"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No acceptable clusters for M/B separation under Method: single for 3 PCs"
[1] "PCs: 3 Clustering method: average"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 10 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 10 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 10 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PCs: 3 Clustering method: ward.D2"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PCs: 7 Clustering method: complete"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No acceptable clusters for M/B separation under Method: single for 7 PCs"
[1] "No acceptable clusters for M/B separation under Method: average for 7 PCs"
[1] "PCs: 7 Clustering method: ward.D2"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PCs: 30 Clustering method: complete"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_text).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No acceptable clusters for M/B separation under Method: single for 30 PCs"
[1] "No acceptable clusters for M/B separation under Method: average for 30 PCs"
[1] "PCs: 30 Clustering method: ward.D2"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-32-9.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="prediction" class="level1">
<h1>Prediction</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/new-samples-CSV"</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>npc <span class="ot">&lt;-</span> <span class="fu">predict</span>(wisc.pr, <span class="at">newdata=</span>new)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>npc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PC1       PC2        PC3        PC4       PC5        PC6        PC7
[1,]  2.576616 -3.135913  1.3990492 -0.7631950  2.781648 -0.8150185 -0.3959098
[2,] -4.754928 -3.009033 -0.1660946 -0.6052952 -1.140698 -1.2189945  0.8193031
            PC8       PC9       PC10      PC11      PC12      PC13     PC14
[1,] -0.2307350 0.1029569 -0.9272861 0.3411457  0.375921 0.1610764 1.187882
[2,] -0.3307423 0.5281896 -0.4855301 0.7173233 -1.185917 0.5893856 0.303029
          PC15       PC16        PC17        PC18        PC19       PC20
[1,] 0.3216974 -0.1743616 -0.07875393 -0.11207028 -0.08802955 -0.2495216
[2,] 0.1299153  0.1448061 -0.40509706  0.06565549  0.25591230 -0.4289500
           PC21       PC22       PC23       PC24        PC25         PC26
[1,]  0.1228233 0.09358453 0.08347651  0.1223396  0.02124121  0.078884581
[2,] -0.1224776 0.01732146 0.06316631 -0.2338618 -0.20755948 -0.009833238
             PC27        PC28         PC29         PC30
[1,]  0.220199544 -0.02946023 -0.015620933  0.005269029
[2,] -0.001134152  0.09638361  0.002795349 -0.019015820</code></pre>
</div>
</div>
<p>Q16: Based on the graph, patient 1 should be prioritized for follow up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wisc.pr<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col =</span> g)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(npc[,<span class="dv">1</span>], npc[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">3</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(npc[,<span class="dv">1</span>], npc[,<span class="dv">2</span>], <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class08_mini_project_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>